<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/styles/HomePage.css" />
  <link rel="stylesheet" href="/styles/Banner.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/js/toggleDropdown.js" defer></script>
  <title>Investify</title>
</head>

<body>
  <%- include("partials/header.ejs") %>

    <!-- Main Container -->
    <main id="container">
      <div id="portfolioBox">
        <div id="titleContainer">
          <h6>Your Portfolio</h6>
          <p id="username">
            <%= locals.username %>'s account
          </p>
        </div>

        <div>
          <div id="informationItem">
            <p style="opacity: 0.65;">Settled Cash</p>
            <p>
              <%= account.settled_cash %>
            </p>
          </div>

          <div id="informationItem">
            <p style="opacity: 0.65;">Buying Power</p>
            <p>
              <%= account.buying_power %>
            </p>
          </div>

          <div id="informationItem">
            <p style="opacity: 0.65;">Dividends</p>
            <p>
              <%= account.dividends %>
            </p>
          </div>
        </div>

        <div id="buttonContainer">
          <button id="buttonItem"><span>Deposit</span></button>
          <button id="buttonItem"><span>Withdraw</span></button>
          <button id="buttonItem"><span>Sell All</span></button>
        </div>

        <div>
          <h6>Positions</h6>

          <% if(locals.position){ %>
            <% position.forEach((item)=> { %>
              <div id="positionItem">
                <p>
                  <%= item.name %>
                </p>

                <% if(item.unrealized_gains> 0){ %>
                  <p id="positiveTrendColor">+<%= item.unrealized_gains %>%<i class="fa-solid fa-arrow-trend-up"></i></p>
                  <% } else if (item.unrealized_gains < 0) { %>
                    <p id="negativeTrendColor">
                      <%= item.unrealized_gains %>%<i class="fa-solid fa-arrow-trend-down"></i>
                    </p>
                    <% } else { %>
                      <%= item.unrealized_gains %>
                        <% } %>

              </div>
              <% }) %>
                <% } %>

        </div>
      </div>


      <!------------------ Line Graph ------------------>
      <div id="lineGraphBox">
        <div id="titleContainer">
          <span style="opacity: 0.65; margin: 0;">Net Account Value</span>
          <h1>
            <%= account.balance %>
          </h1>
        </div>

        <div>
          <hr id="borderLine">
        </div>

        <div id="graphContainer">
          <div class="chart">
            <canvas id="lineGraph"></canvas>
          </div>
        </div>
      </div>


      <!------------------ Doughnut Chart ------------------>
      <div id="doughnutGraphBox">
        <div id="titleContainer">
          <h6 style="text-align: center;">Asset Allocation</h6>
        </div>

        <div>
          <hr id="borderLine">
        </div>

        <div id="graphContainer">
          <div class="chart">
            <canvas id="doughnutChart"></canvas>
          </div>
        </div>
      </div>

      <div id="recommendedBox">
        <div id="titleContainer">
          <h6>Discover Investments</h6>
        </div>

        <div id="recommendedItem">
          <p>AMC Entertainment Inc</p>
          <p id="positiveTrendColor">+8.4%<i class="fa-solid fa-arrow-trend-up"></i></p>
        </div>

        <div id="recommendedItem">
          <p>Marathon Digital</p>
          <p id="positiveTrendColor">+2.4%<i class="fa-solid fa-arrow-trend-up"></i></p>
        </div>

        <div id="recommendedItem">
          <p>Intel Corporation</p>
          <p id="positiveTrendColor">+1.7%<i class="fa-solid fa-arrow-trend-up"></i></p>
        </div>
      </div>

      <div id="transactionBox">
        <div id="titleContainer">
          <h6>Transactions</h6>
        </div>

        <div id="borderLine">
        </div>

        <table id="transactionTable">

          <thead id="headerBlock">
            <tr>
              <td id="headerCells">Name</td>
              <td id="headerCells">Category</td>
              <td id="headerCells">Date</td>
              <td id="headerCells">Amount</td>
            </tr>
          </thead>

          <tbody id="positionRow">
            <tr>
              <td data-cell="name" id="name">
                Walmart
              </td>

              <td data-cell="category" id="category">
                Shops
              </td>

              <td data-cell="date" id="date">
                2023-09-30
              </td>

              <td data-cell="amount" id="amount">
                $72.10
              </td>
            </tr>

            <tr>
              <td data-cell="name" id="name">
                Best Buy
              </td>

              <td data-cell="category" id="category">
                Electronics
              </td>

              <td data-cell="date" id="date">
                2023-09-28
              </td>

              <td data-cell="amount" id="amount">
                $84.30
              </td>
            </tr>

            <tr>
              <td data-cell="name" id="name">
                DoorDash
              </td>

              <td data-cell="category" id="category">
                Food and Drink
              </td>

              <td data-cell="date" id="date">
                2023-09-24
              </td>

              <td data-cell="amount" id="amount">
                $23.94
              </td>
            </tr>

          </tbody>

        </table>

      </div>

      </div>
    </main>

    <script src="/js/chart.js"></script>
</body>

</html>